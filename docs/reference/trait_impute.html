<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Impute traits — trait_impute • traitstrap</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Impute traits — trait_impute" />
<meta property="og:description" content="A function for trait imputation using a hierarchical sampling design, 
which allows to account for incomplete trait collections, traits from different 
spatial or temporal levels (i.e. local traits vs. databases) and experimental designs.

" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">traitstrap</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.901</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/traitstrap-workflow.html">traitstrap-workflow</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/richardjtelford/traitstrap/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Impute traits</h1>
    <small class="dont-index">Source: <a href='https://github.com/richardjtelford/traitstrap/blob/master/R/trait_impute.R'><code>R/trait_impute.R</code></a></small>
    <div class="hidden name"><code>trait_impute.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A function for trait imputation using a hierarchical sampling design, 
which allows to account for incomplete trait collections, traits from different 
spatial or temporal levels (i.e. local traits vs. databases) and experimental designs.</p>


    </div>

    <pre class="usage"><span class='fu'>trait_impute</span><span class='op'>(</span>
  <span class='va'>comm</span>,
  <span class='va'>traits</span>,
  scale_hierarchy <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Country"</span>, <span class='st'>"Site"</span>, <span class='st'>"BlockID"</span>, <span class='st'>"PlotID"</span><span class='op'>)</span>,
  global <span class='op'>=</span> <span class='cn'>TRUE</span>,
  taxon_col <span class='op'>=</span> <span class='st'>"taxon"</span>,
  trait_col <span class='op'>=</span> <span class='st'>"trait"</span>,
  value_col <span class='op'>=</span> <span class='st'>"Value"</span>,
  abundance_col <span class='op'>=</span> <span class='st'>"Cover"</span>,
  treatment_col <span class='op'>=</span> <span class='cn'>NULL</span>,
  treatment_level <span class='op'>=</span> <span class='cn'>NULL</span>,
  other_col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>,
  keep_all <span class='op'>=</span> <span class='cn'>FALSE</span>,
  min_n_in_sample <span class='op'>=</span> <span class='fl'>5</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>comm</th>
      <td><p>a datafram in long format with community data</p></td>
    </tr>
    <tr>
      <th>traits</th>
      <td><p>a dataframe in long format with trait data</p></td>
    </tr>
    <tr>
      <th>scale_hierarchy</th>
      <td><p>character vector of the sampling hierarchy from large 
to small (e.g. site/block/plot)</p></td>
    </tr>
    <tr>
      <th>global</th>
      <td><p>logical; calculate traits at global scale.
Must not be a column called global in the traits data.</p></td>
    </tr>
    <tr>
      <th>taxon_col</th>
      <td><p>character; name of taxon column in comm and traits.
Can be a vector (e.g. "species", "genus"), in which case if traits cannot be 
imputed for the first taxon column, subsequent columns will be used in order.</p></td>
    </tr>
    <tr>
      <th>trait_col</th>
      <td><p>character; name of trait name column in traits</p></td>
    </tr>
    <tr>
      <th>value_col</th>
      <td><p>character; name of trait value column in traits</p></td>
    </tr>
    <tr>
      <th>abundance_col</th>
      <td><p>character; name of species abundance column in comm</p></td>
    </tr>
    <tr>
      <th>treatment_col</th>
      <td><p>character; optional name of treatment_col in comm and
traits. Must refer to a factor where first level is control.</p></td>
    </tr>
    <tr>
      <th>treatment_level</th>
      <td><p>character; optional name of scale_hierarchy at which
treatment should be filtered</p></td>
    </tr>
    <tr>
      <th>other_col</th>
      <td><p>name of other grouping columns in comm</p></td>
    </tr>
    <tr>
      <th>keep_all</th>
      <td><p>logical; keep trait data at all available levels
or just finest scale available</p></td>
    </tr>
    <tr>
      <th>min_n_in_sample</th>
      <td><p>numeric; minimum number in sample with traits to accept before
searching for traits higher up the hierarchy. The default is 5.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a tibble with extra class <code>imputed_trait</code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function uses a hierarchical sampling design, which allows it to 
account for incomplete trait collections, traits from different spatial or temporal
levels (i.e. local traits vs. databases) and/or experimental designs.</p>
<p>With scale_hierarchy you can define the levels at which the traits have been 
collected and their order starting with the highest level (e.g. global database, 
region, site, block, plot).</p>
<p>The trait_impute function will choose if available a trait value from the lowest 
level, i.e. species X from plot A and if no trait is available from that level, 
it will move up the hierarchy and choose a trait from species X from plot B at 
the same site. If there is no trait available from species X in the same site, it 
will choose a trait value from another site.</p>
<p>The argument min_n_in_samples allows users to define the minimum number in sample
at each level for the trait imputation. If the minimum number is not reached, trait
values from the next level will also be imputed, to avoid sampling the same 
individual several times, which will result in unrealistic variances. The default 
value is 5</p>
<p>In the other_col arumgent other grouping variable in the community dataset can be 
defined and will be kept after the trait imputation step.</p>
<p>Traitstrap also allows to include taxonomy and experimental design in the 
trait imputation step.</p>
<p>With taxon_col a hierarchy for the taxonomy can be defined. If traits for a specific
species are not available, traits from next level, e.g. the genus will be imputed.
For this a list of the taxonomic hierarchy has to be defined (e.g. "taxon", 
"genus", "family").</p>
<p>The argument treatment_col allows to incorporate an experimental design where 
traits are imputed from the same experimental treatment or the first factor 
level, which is assumed to be the control. Therefore, it is important to order 
the levels of a treatment in the right order, i.e. the first level has to be 
the control. The imputation step can be defined at certain level using the
treatment_level argument. Depending on the experimental design trait imputation
should occur a certain level, e.g. block or site.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>community</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>trait</span><span class='op'>)</span>
<span class='va'>imputed_traits</span> <span class='op'>&lt;-</span><span class='fu'>trait_impute</span><span class='op'>(</span>comm <span class='op'>=</span> <span class='va'>community</span>, traits <span class='op'>=</span> <span class='va'>trait</span>,
                 scale_hierarchy <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Site"</span>, <span class='st'>"PlotID"</span><span class='op'>)</span>,
                 taxon_col <span class='op'>=</span> <span class='st'>"Taxon"</span>, value_col <span class='op'>=</span> <span class='st'>"Value"</span>,
                 trait_col <span class='op'>=</span> <span class='st'>"Trait"</span>, abundance_col <span class='op'>=</span> <span class='st'>"Cover"</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Richard J. Telford, Aud Halbritter, Brian S. Maitner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


